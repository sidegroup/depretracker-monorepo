<div class="extrator-container">
<mat-card class="home-card">
  <mat-card-header class="card-header">
    <mat-card-title>
      <div class="social-icons">
        <!-- Ícone Reddit -->
        <img src="assets/icons/reddit-icon.svg"
             alt="Reddit"
             class="icon-button"
             [class.active]="activeForm === 'reddit'"
             (click)="activeForm = 'reddit'">

        <!-- Ícone Instagram -->
        <img src="assets/icons/instagram-icon.svg"
             alt="Instagram"
             class="icon-button"
             [class.active]="activeForm === 'instagram'"
             (click)="activeForm = 'instagram'">
      </div>
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <!-- Formulário Reddit -->
    <form *ngIf="activeForm === 'reddit'"
          [formGroup]="redditForm"
          (ngSubmit)="onSubmit()"
          class="form-container">
      <mat-form-field appearance="fill" class="full-width" matTooltip="Acesse https://www.reddit.com/prefs/apps para criar suas credenciais">
        <mat-label>Client ID</mat-label>
        <input matInput formControlName="client_id" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Client Secret</mat-label>
        <input matInput formControlName="client_secret" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Username</mat-label>
        <input matInput formControlName="username" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Password</mat-label>
        <input matInput type="password" formControlName="password" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>User Agent</mat-label>
        <input matInput formControlName="user_agent" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width" matTooltip="Use OR para múltiplas search string (ex: cats OR dogs)">
        <mat-label>Search String</mat-label>
        <textarea matInput formControlName="search_string" required></textarea>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width" matTooltip="Separe múltiplos subreddits por vírgula (ex: funny, gaming, pics). Para nomes compostos, use underscores ou o nome oficial conforme a URL (ex: dataisbeautiful, Imaginary_Networks, OldSchoolCool).">
        <mat-label>Subreddits</mat-label>
        <textarea matInput formControlName="subreddits" required></textarea>
      </mat-form-field>

      <button mat-raised-button color="primary" type="submit" [disabled]="redditForm.invalid">
        Extrair do Reddit
      </button>
    </form>

    <!-- Formulário Instagram -->
    <form *ngIf="activeForm === 'instagram'"
          [formGroup]="instagramForm"
          (ngSubmit)="onSubmit()"
          class="form-container">
      <mat-form-field appearance="fill" class="full-width" matTooltip="Obtenha no Facebook Developer">
        <mat-label>App ID</mat-label>
        <input matInput formControlName="app_id" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>App Secret</mat-label>
        <input matInput formControlName="app_secret" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width" matTooltip="Gere um token com permissões: `instagram_basic`, `pages_show_list`" >
        <mat-label>Access Token</mat-label>
        <input matInput formControlName="access_token" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width" matTooltip="Encontre no 'Instagram Professional Dashboard'">
        <mat-label>Instagram Account ID</mat-label>
        <input matInput formControlName="account_id" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width" matTooltip="Separe hashtags por vírgula (ex: tech, travel, food)">
        <mat-label>Hashtags</mat-label>
        <textarea matInput formControlName="hashtags"></textarea>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width" matTooltip="Separe usuários por vírgula (ex: nike, natgeo)">
        <mat-label>Target Accounts</mat-label>
        <textarea matInput formControlName="target_accounts"></textarea>
      </mat-form-field>

      <button mat-raised-button color="primary" type="submit" [disabled]="instagramForm.invalid">
        Extrair do Instagram
      </button>
    </form>

    <!-- Spinner de carregamento -->
    <div *ngIf="loading" class="loading-container">
      <mat-spinner></mat-spinner>
      <p>{{ activeForm === 'reddit' ? 'Extraindo do Reddit...' : 'Extraindo do Instagram...' }}</p>
    </div>
  </mat-card-content>
</mat-card>
</div>
